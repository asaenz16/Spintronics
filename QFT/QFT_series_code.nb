(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     41455,       1145]
NotebookOptionsPosition[     39005,       1091]
NotebookOutlinePosition[     39399,       1107]
CellTagsIndexPosition[     39356,       1104]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["QFT Series Expansion", "Title",
 CellChangeTimes->{{3.9502578027437487`*^9, 
  3.950257808244486*^9}},ExpressionUUID->"7884527a-e065-4561-a295-\
7d5692e4febc"],

Cell[CellGroupData[{

Cell["Operators", "Section",
 CellChangeTimes->{{3.9502580367247458`*^9, 
  3.950258038475116*^9}},ExpressionUUID->"c3b5e4ec-ea93-4961-85c1-\
5e8f70860ce1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sp", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sm", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sz", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", " ", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ops", " ", "=", 
   RowBox[{"{", 
    RowBox[{"Sp", ",", " ", "Sm", ",", " ", "Sz", ",", " ", 
     RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.950258040629895*^9, 3.9502580831537848`*^9}, {
  3.950620630929696*^9, 3.950620631845932*^9}},
 CellLabel->
  "In[221]:=",ExpressionUUID->"87c9627e-e1dd-4fdf-8838-c3d3f2553658"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Non-interacting Fields", "Section",
 CellChangeTimes->{{3.950257825285606*^9, 3.950257833636393*^9}, {
  3.9502580000336742`*^9, 
  3.95025802096852*^9}},ExpressionUUID->"82a25375-f035-4bc2-9ed4-\
0397bf2ebfc9"],

Cell[CellGroupData[{

Cell["External Magnetic Field", "Subsection",
 CellChangeTimes->{{3.9502581012617407`*^9, 
  3.950258111554655*^9}},ExpressionUUID->"f3fbc352-c138-4e7b-8240-\
94c9841fd137"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"hm", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hp", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hz", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HbExp", "[", "\[Beta]_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cosh", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"hm", " ", "hp"}], "+", 
            SuperscriptBox["hz", "2"]}]], " ", "\[Beta]"}], "]"}], "+", 
        FractionBox[
         RowBox[{"hz", " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{
            SqrtBox[
             RowBox[{
              RowBox[{"hm", " ", "hp"}], "+", 
              SuperscriptBox["hz", "2"]}]], " ", "\[Beta]"}], "]"}]}], 
         SqrtBox[
          RowBox[{
           RowBox[{"hm", " ", "hp"}], "+", 
           SuperscriptBox["hz", "2"]}]]]}], ",", 
       FractionBox[
        RowBox[{"hm", " ", 
         RowBox[{"Sinh", "[", 
          RowBox[{
           SqrtBox[
            RowBox[{
             RowBox[{"hm", " ", "hp"}], "+", 
             SuperscriptBox["hz", "2"]}]], " ", "\[Beta]"}], "]"}]}], 
        SqrtBox[
         RowBox[{
          RowBox[{"hm", " ", "hp"}], "+", 
          SuperscriptBox["hz", "2"]}]]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"hp", " ", 
         RowBox[{"Sinh", "[", 
          RowBox[{
           SqrtBox[
            RowBox[{
             RowBox[{"hm", " ", "hp"}], "+", 
             SuperscriptBox["hz", "2"]}]], " ", "\[Beta]"}], "]"}]}], 
        SqrtBox[
         RowBox[{
          RowBox[{"hm", " ", "hp"}], "+", 
          SuperscriptBox["hz", "2"]}]]], ",", 
       RowBox[{
        RowBox[{"Cosh", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"hm", " ", "hp"}], "+", 
            SuperscriptBox["hz", "2"]}]], " ", "\[Beta]"}], "]"}], "-", 
        FractionBox[
         RowBox[{"hz", " ", 
          RowBox[{"Sinh", "[", 
           RowBox[{
            SqrtBox[
             RowBox[{
              RowBox[{"hm", " ", "hp"}], "+", 
              SuperscriptBox["hz", "2"]}]], " ", "\[Beta]"}], "]"}]}], 
         SqrtBox[
          RowBox[{
           RowBox[{"hm", " ", "hp"}], "+", 
           SuperscriptBox["hz", "2"]}]]]}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.9503100143290033`*^9, {3.95031524428356*^9, 3.950315294125619*^9}, {
   3.9503157743767014`*^9, 3.95031577644241*^9}, {3.950620641358018*^9, 
   3.95062064259734*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"7f31551c-61b9-4274-bd42-d97f36a7b390"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Correlations", "Subsection",
 CellChangeTimes->{{3.950258127155603*^9, 
  3.950258129966742*^9}},ExpressionUUID->"02f1c2a9-1f4b-4d99-ba88-\
65f5c307c733"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Corr", "[", 
   RowBox[{"OpsList_", ",", " ", "\[Beta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"op", ",", " ", "n", ",", " ", "i"}], "}"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"op", " ", "=", " ", 
      RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", " ", 
      RowBox[{"Length", "[", "OpsList", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", " ", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", "  ", "n"}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", 
       RowBox[{"op", " ", "=", " ", 
        RowBox[{"op", ".", 
         RowBox[{"HbExp", "[", 
          RowBox[{
           RowBox[{"OpsList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], ".", " ", 
         RowBox[{"Ops", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"OpsList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ".", 
         RowBox[{"HbExp", "[", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{"OpsList", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"op", " ", "=", " ", 
      RowBox[{"op", ".", " ", 
       RowBox[{"HbExp", "[", "\[Beta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Tr", "[", "op", "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.950258164975896*^9, 3.95025830557286*^9}, {
  3.9502583910212097`*^9, 3.9502584502134123`*^9}, {3.9502584981639757`*^9, 
  3.95025859554235*^9}, {3.950258851328185*^9, 3.950258855674919*^9}, {
  3.950258886832059*^9, 3.950258918782497*^9}, {3.950259056810458*^9, 
  3.950259083784122*^9}, {3.95025916740698*^9, 3.950259170087182*^9}, {
  3.950315605950232*^9, 3.950315633328506*^9}, {3.950602184556136*^9, 
  3.950602185026678*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"5e9dd9e2-e4b3-4302-a311-bd4110a737b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interaction Paths", "Subsection",
 CellChangeTimes->{{3.950300775518195*^9, 3.950300780310018*^9}, {
  3.950306166404375*^9, 
  3.950306170282309*^9}},ExpressionUUID->"c74962ec-7575-4f1f-a4ec-\
7cd46e6098e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Interactions", "[", 
   RowBox[{"\[Lambda]_", ",", "len_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "int", " ", ",", "Paths", ",", " ", "SpinLabels", ",", " ", "i", ",", 
      " ", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Paths", " ", "=", " ", 
      RowBox[{"Tuples", "[", 
       RowBox[{
        RowBox[{"Range", "[", "\[Lambda]", "]"}], ",", 
        RowBox[{"2", " ", "len"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SpinLabels", " ", "=", 
      RowBox[{"Tuples", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", " ", 
        RowBox[{"2", " ", "len"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"int", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"Length", "[", "Paths", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", " ", 
         RowBox[{"j", " ", "<=", " ", 
          RowBox[{"Length", "[", "SpinLabels", "]"}]}], ",", " ", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Product", "[", 
             RowBox[{
              RowBox[{"V", "[", 
               RowBox[{
                RowBox[{"\[CapitalLambda]", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Paths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "k"}], "-", "1"}], "]"}], "]"}], "]"}], 
                 "]"}], ",", 
                RowBox[{"\[CapitalLambda]", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Paths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"2", "k"}], "]"}], "]"}], "]"}], "]"}], " ", ",", 
                " ", 
                RowBox[{
                 RowBox[{"SpinLabels", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", "k"}], "-", "1"}], "]"}], "]"}], ",", " ", 
                RowBox[{
                 RowBox[{"SpinLabels", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"2", "k"}], "]"}], "]"}]}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"k", ",", " ", "1", ",", " ", "len"}], "}"}]}], "]"}], 
            "!=", " ", "0"}], ",", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"int", ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Paths", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
               RowBox[{"SpinLabels", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
        " ", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "int", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.950305969307776*^9, 3.9503060852285023`*^9}, {
  3.950314565118018*^9, 3.95031458455732*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"ba490981-842d-4485-aa95-994ff53e26d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interaction Contribution", "Subsection",
 CellChangeTimes->{{3.950307080597983*^9, 3.9503071220522547`*^9}, {
  3.950309092738494*^9, 
  3.950309096474269*^9}},ExpressionUUID->"fd42a6c4-f2fe-4321-b8d5-\
1712810143e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"InteractionContribution", "[", 
   RowBox[{"\[Lambda]_", ",", " ", "path_", ",", " ", "\[Beta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "OpsLists", ",", " ", "i", ",", " ", "\[Tau]", ",", "InterTerm", ",", 
      " ", "InterCoupling", ",", "k", ",", " ", "n"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"path", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"OpsLists", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "\[Lambda]"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "==", "0"}], ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"Corr", "[", 
           RowBox[{
            RowBox[{"OpsLists", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\[Beta]"}], "]"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "OpsLists", "]"}]}], "}"}]}], "]"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"2", "n"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"OpsLists", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"path", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"path", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
           RowBox[{"\[Tau]", "[", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "+", "1"}], ")"}], "/", "2"}], "]"}], "]"}]}], 
          "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"InterTerm", " ", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"Corr", "[", 
         RowBox[{
          RowBox[{"OpsLists", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\[Beta]"}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "OpsLists", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InterCoupling", " ", "=", " ", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"2", " ", "i"}], "-", "1"}], "]"}], "]"}], "]"}], 
           "]"}], ",", " ", 
          RowBox[{"\[CapitalLambda]", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", " ", "i"}], "]"}], "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", " ", "i"}], "-", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", " ", "i"}], "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", " ", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"path", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["1", 
         RowBox[{"n", "!"}]], ")"}], " ", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"InterCoupling", "*", " ", "InterTerm"}], ",", " ", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Tau]", "[", "k", "]"}], ",", " ", "0", ",", " ", 
              "\[Beta]"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"k", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}]}], 
        "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NInteractionContribution", "[", 
   RowBox[{"\[Lambda]_", ",", " ", "path_", ",", " ", "\[Beta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "OpsLists", ",", " ", "i", ",", " ", "\[Tau]", ",", "InterTerm", ",", 
      " ", "InterCoupling", ",", "k", ",", " ", "n"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"path", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"OpsLists", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "\[Lambda]"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "==", "0"}], ",", " ", 
       RowBox[{"Return", "[", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"Corr", "[", 
           RowBox[{
            RowBox[{"OpsLists", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\[Beta]"}], "]"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", 
            RowBox[{"Length", "[", "OpsLists", "]"}]}], "}"}]}], "]"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"2", "n"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"OpsLists", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"path", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"path", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
           RowBox[{"\[Tau]", "[", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "+", "1"}], ")"}], "/", "2"}], "]"}], "]"}]}], 
          "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"InterTerm", " ", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"Corr", "[", 
         RowBox[{
          RowBox[{"OpsLists", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\[Beta]"}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "OpsLists", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InterCoupling", " ", "=", " ", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", " ", "i"}], "-", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", " ", "i"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", " ", "i"}], "-", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", " ", "i"}], "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", " ", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"path", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["1", 
         RowBox[{"n", "!"}]], ")"}], " ", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"InterCoupling", "*", " ", "InterTerm"}], ",", " ", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\[Tau]", "[", "k", "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"k", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}], 
          "\[Element]", 
          RowBox[{"Cuboid", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", " ", 
              RowBox[{"{", 
               RowBox[{"k", ",", " ", "1", ",", "n"}], "}"}]}], "]"}], ",", 
            " ", 
            RowBox[{"Table", "[", 
             RowBox[{"\[Beta]", ",", " ", 
              RowBox[{"{", 
               RowBox[{"k", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
           "]"}]}]}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.950320283105357*^9, 3.950320358133954*^9}, {
  3.950599255338916*^9, 3.95059927115701*^9}, {3.950599841744532*^9, 
  3.9505998543090773`*^9}, {3.9505999123177223`*^9, 3.950599920321397*^9}, {
  3.950600060617778*^9, 3.950600067476931*^9}, {3.950600771739543*^9, 
  3.950600862485855*^9}, {3.9506009034101963`*^9, 3.9506009234759617`*^9}, {
  3.950630952198708*^9, 3.950630966289885*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"ab94a3aa-9e4d-4d6f-ba93-60d84c4d7c0e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partition Function", "Section",
 CellChangeTimes->{{3.950309881745472*^9, 
  3.950309885047961*^9}},ExpressionUUID->"695a2a33-7c24-47d7-8f48-\
7982828d33a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Z", "[", 
   RowBox[{"deg_", ",", " ", "\[Beta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"paths", ",", " ", "i", ",", " ", "len"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"paths", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Interactions", "[", 
           RowBox[{"\[Lambda]", ",", " ", "len"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"len", ",", " ", "0", ",", " ", "deg"}], "}"}]}], "]"}], 
        ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"InteractionContribution", "[", 
         RowBox[{"\[Lambda]", ",", " ", 
          RowBox[{"paths", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\[Beta]"}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "paths", "]"}]}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", " ", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NZ", "[", 
   RowBox[{"deg_", ",", " ", "\[Beta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"paths", ",", " ", "i", ",", " ", "len"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"paths", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Interactions", "[", 
           RowBox[{"\[Lambda]", ",", " ", "len"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"len", ",", " ", "0", ",", " ", "deg"}], "}"}]}], "]"}], 
        ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"NInteractionContribution", "[", 
         RowBox[{"\[Lambda]", ",", " ", 
          RowBox[{"paths", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\[Beta]"}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "paths", "]"}]}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", " ", "]"}]}]}], "Input",
 CellChangeTimes->{{3.950312482812457*^9, 3.950312583747778*^9}, {
   3.9505993009188833`*^9, 3.950599305151335*^9}, 3.950599513159314*^9},
 CellLabel->
  "In[233]:=",ExpressionUUID->"23aecb75-035c-4cf5-a6ba-bb08c21cec0e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["One-point Correlation Function", "Section",
 CellChangeTimes->{{3.9503160267251253`*^9, 
  3.9503160349487553`*^9}},ExpressionUUID->"3578e12d-c8bc-4fc2-98a5-\
e7e803dfbfd4"],

Cell[CellGroupData[{

Cell["Contributions", "Subsection",
 CellChangeTimes->{{3.950324040523444*^9, 
  3.9503240429322577`*^9}},ExpressionUUID->"076efdfa-430b-4780-8370-\
7a6b6828253d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OnePointContribution", "[", 
   RowBox[{
   "\[Lambda]_", ",", " ", "path_", ",", " ", "\[Beta]_", ",", "vertexIndex_",
     ",", " ", "spinIndex_", ",", " ", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "OpsLists", ",", " ", "i", ",", " ", "\[Tau]", ",", "InterTerm", ",", 
      " ", "InterCoupling", ",", "k", ",", " ", "n"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"path", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"OpsLists", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "\[Lambda]"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"2", "n"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"OpsLists", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"path", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"path", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
           RowBox[{"\[Tau]", "[", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "+", "1"}], ")"}], "/", "2"}], "]"}], "]"}]}], 
          "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{
       RowBox[{"OpsLists", "[", 
        RowBox[{"[", "vertexIndex", "]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"spinIndex", ",", " ", "t"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InterTerm", " ", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"Corr", "[", 
         RowBox[{
          RowBox[{"OpsLists", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\[Beta]"}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "OpsLists", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "==", "0"}], ",", " ", 
       RowBox[{"Return", "[", "InterTerm", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InterCoupling", " ", "=", " ", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"2", " ", "i"}], "-", "1"}], "]"}], "]"}], "]"}], 
           "]"}], ",", " ", 
          RowBox[{"\[CapitalLambda]", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"path", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"2", " ", "i"}], "]"}], "]"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", " ", "i"}], "-", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", " ", "i"}], "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", " ", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"path", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["1", 
         RowBox[{"n", "!"}]], ")"}], " ", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"InterCoupling", "*", " ", "InterTerm"}], ",", " ", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Tau]", "[", "k", "]"}], ",", " ", "0", ",", " ", 
              "\[Beta]"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"k", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}]}], 
        "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NOnePointContribution", "[", 
   RowBox[{
   "\[Lambda]_", ",", " ", "path_", ",", " ", "\[Beta]_", ",", "vertexIndex_",
     ",", " ", "spinIndex_", ",", " ", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "OpsLists", ",", " ", "i", ",", " ", "\[Tau]", ",", "InterTerm", ",", 
      " ", "InterCoupling", ",", "k", ",", " ", "n"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"path", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"OpsLists", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "\[Lambda]"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", " ", 
       RowBox[{"i", " ", "<=", " ", 
        RowBox[{"2", "n"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"OpsLists", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"path", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"path", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
           RowBox[{"\[Tau]", "[", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", "+", "1"}], ")"}], "/", "2"}], "]"}], "]"}]}], 
          "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{
       RowBox[{"OpsLists", "[", 
        RowBox[{"[", "vertexIndex", "]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"spinIndex", ",", " ", "t"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InterTerm", " ", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"Corr", "[", 
         RowBox[{
          RowBox[{"OpsLists", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\[Beta]"}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "OpsLists", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "==", "0"}], ",", " ", 
       RowBox[{"Return", "[", "InterTerm", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InterCoupling", " ", "=", " ", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", " ", "i"}], "-", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", " ", "i"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"2", " ", "i"}], "-", "1"}], "]"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"path", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", " ", "i"}], "]"}], "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", " ", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"path", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "/", "2"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["1", 
         RowBox[{"n", "!"}]], ")"}], " ", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"InterCoupling", "*", " ", "InterTerm"}], ",", " ", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\[Tau]", "[", "k", "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"k", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}], 
          "\[Element]", 
          RowBox[{"Cuboid", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", " ", 
              RowBox[{"{", 
               RowBox[{"k", ",", " ", "1", ",", "n"}], "}"}]}], "]"}], ",", 
            " ", 
            RowBox[{"Table", "[", 
             RowBox[{"\[Beta]", ",", " ", 
              RowBox[{"{", 
               RowBox[{"k", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
           "]"}]}]}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.950320600772575*^9, 3.950320628912236*^9}, {
   3.950323415579842*^9, 3.95032342220313*^9}, {3.950325395047905*^9, 
   3.950325395757718*^9}, {3.9503255014549713`*^9, 3.950325540592743*^9}, {
   3.950601258102103*^9, 3.950601265630177*^9}, 3.950601305392749*^9, {
   3.950631036217656*^9, 3.95063104791858*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"92b55106-e37e-45ec-acfc-0af05f1fc752"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expansion", "Subsection",
 CellChangeTimes->{{3.950324083805812*^9, 
  3.950324086762877*^9}},ExpressionUUID->"4256b311-e058-479d-9713-\
3203e453ed61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OnePoint", "[", 
   RowBox[{
   "deg_", ",", " ", "\[Beta]_", ",", " ", "vertexIndex_", ",", " ", 
    "spinIndex_", ",", " ", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"paths", ",", " ", "i", ",", " ", "len"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"paths", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Interactions", "[", 
           RowBox[{"\[Lambda]", ",", " ", "len"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"len", ",", " ", "0", ",", " ", "deg"}], "}"}]}], "]"}], 
        ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"OnePointContribution", "[", 
         RowBox[{"\[Lambda]", ",", " ", 
          RowBox[{"paths", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\[Beta]", ",", " ", 
          "vertexIndex", ",", " ", "spinIndex", ",", " ", "t"}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "paths", "]"}]}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", " ", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NOnePoint", "[", 
   RowBox[{
   "deg_", ",", " ", "\[Beta]_", ",", " ", "vertexIndex_", ",", " ", 
    "spinIndex_", ",", " ", "t_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"paths", ",", " ", "i", ",", " ", "len"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"paths", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Interactions", "[", 
           RowBox[{"\[Lambda]", ",", " ", "len"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"len", ",", " ", "0", ",", " ", "deg"}], "}"}]}], "]"}], 
        ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"NOnePointContribution", "[", 
         RowBox[{"\[Lambda]", ",", " ", 
          RowBox[{"paths", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\[Beta]", ",", " ", 
          "vertexIndex", ",", " ", "spinIndex", ",", " ", "t"}], "]"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "paths", "]"}]}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", " ", "]"}]}]}], "Input",
 CellChangeTimes->{{3.950324059381042*^9, 3.950324172635742*^9}, {
  3.950601475719948*^9, 3.9506014813845797`*^9}, {3.950602234449347*^9, 
  3.9506022354082127`*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"def4a091-15e2-4b9a-85f4-e6eb07bd9a62"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{688.5, 638.25},
WindowMargins->{{27, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Linux x86 (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"66934eb2-b734-4961-8f53-467436ea8b16"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 165, 3, 98, "Title",ExpressionUUID->"7884527a-e065-4561-a295-7d5692e4febc"],
Cell[CellGroupData[{
Cell[770, 29, 156, 3, 67, "Section",ExpressionUUID->"c3b5e4ec-ea93-4961-85c1-5e8f70860ce1"],
Cell[929, 34, 1215, 38, 98, "Input",ExpressionUUID->"87c9627e-e1dd-4fdf-8838-c3d3f2553658"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2181, 77, 217, 4, 67, "Section",ExpressionUUID->"82a25375-f035-4bc2-9ed4-0397bf2ebfc9"],
Cell[CellGroupData[{
Cell[2423, 85, 173, 3, 54, "Subsection",ExpressionUUID->"f3fbc352-c138-4e7b-8240-94c9841fd137"],
Cell[2599, 90, 2704, 84, 285, "Input",ExpressionUUID->"7f31551c-61b9-4274-bd42-d97f36a7b390"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5340, 179, 160, 3, 54, "Subsection",ExpressionUUID->"02f1c2a9-1f4b-4d99-ba88-65f5c307c733"],
Cell[5503, 184, 2246, 53, 199, "Input",ExpressionUUID->"5e9dd9e2-e4b3-4302-a311-bd4110a737b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7786, 242, 214, 4, 54, "Subsection",ExpressionUUID->"c74962ec-7575-4f1f-a4ec-7cd46e6098e7"],
Cell[8003, 248, 3596, 89, 295, "Input",ExpressionUUID->"ba490981-842d-4485-aa95-994ff53e26d4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11636, 342, 223, 4, 54, "Subsection",ExpressionUUID->"fd42a6c4-f2fe-4321-b8d5-1712810143e8"],
Cell[11862, 348, 10523, 282, 748, "Input",ExpressionUUID->"ab94a3aa-9e4d-4d6f-ba93-60d84c4d7c0e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22434, 636, 163, 3, 67, "Section",ExpressionUUID->"695a2a33-7c24-47d7-8f48-7982828d33a4"],
Cell[22600, 641, 2540, 66, 232, "Input",ExpressionUUID->"23aecb75-035c-4cf5-a6ba-bb08c21cec0e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25177, 712, 179, 3, 67, "Section",ExpressionUUID->"3578e12d-c8bc-4fc2-98a5-e7e803dfbfd4"],
Cell[CellGroupData[{
Cell[25381, 719, 163, 3, 54, "Subsection",ExpressionUUID->"076efdfa-430b-4780-8370-7a6b6828253d"],
Cell[25547, 724, 10347, 279, 748, "Input",ExpressionUUID->"92b55106-e37e-45ec-acfc-0af05f1fc752"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35931, 1008, 157, 3, 54, "Subsection",ExpressionUUID->"4256b311-e058-479d-9713-3203e453ed61"],
Cell[36091, 1013, 2874, 73, 306, "Input",ExpressionUUID->"def4a091-15e2-4b9a-85f4-e6eb07bd9a62"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

